<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acreditaci√≥n Septiembre 2025 ‚Äì Programaci√≥n 1 (Final)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* CSS Integrado */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #007bff;
            margin-bottom: 30px;
        }
        .card {
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        h2 {
            color: #0056b3;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        p {
            margin-bottom: 15px;
            line-height: 1.5;
        }
        textarea {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            resize: vertical;
            box-sizing: border-box;
            background-color: #f8f8f8;
        }
        .actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        button:first-child {
            background-color: #28a745; 
            color: white;
        }
        button:first-child:hover {
            background-color: #1e7e34;
        }
        button:last-child {
            background-color: #6c757d; 
            color: white;
        }
        button:last-child:hover {
            background-color: #5a6268;
        }
        .console {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #eee;
            background-color: #333;
            color: #f0f0f0;
            border-radius: 4px;
            min-height: 50px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .result-pass {
            color: #28a745;
        }
        .result-fail {
            color: #dc3545;
        }
        .result-error {
            color: #ffc107;
        }
        .result-warn {
            color: #ffc107;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Acreditaci√≥n Septiembre 2025 ‚Äì Programaci√≥n 1</h1>

    <div class="card">
        <h2>Ejercicio 1</h2>
        <p>(___ ptos) Crea un programa en Java que solicite tres n√∫meros y luego imprima¬†
        "Ascendente", "Descendente" o "Sin orden".</p>
        <textarea id="code1" spellcheck="false" rows="10"></textarea>
        <div class="actions">
            <button onclick="runCode(1)">‚ñ∂ Ejecutar</button>
            <button onclick="exportPDF(1)">üìÑ Exportar PDF</button>
        </div>
        <div id="console1" class="console"></div>
    </div>

    <div class="card">
        <h2>Ejercicio 2</h2>
        <p>(___ ptos) Solicitar un n√∫mero entero y calcular la suma desde 1 hasta ese n√∫mero. **Solo debe haber una l√≠nea de salida.**</p>
        <p><strong>Por ejemplo, si ingresamos 5 valores (1 , 2 , 3 ,4 ,5 ), deber√≠a imprimir 15 como resultado de su suma.
</strong></p>
        <textarea id="code2" spellcheck="false" rows="10"></textarea>
        <div class="actions">
            <button onclick="runCode(2)">‚ñ∂ Ejecutar</button>
            <button onclick="exportPDF(2)">üìÑ Exportar PDF</button>
        </div>
        <div id="console2" class="console"></div>
    </div>

    <div class="card">
        <h2>Ejercicio 3</h2>
        <p>(___ ptos) Contar cu√°ntos n√∫meros negativos se ingresan hasta que se escriba 0. **Solo debe haber una l√≠nea de salida.**</p>
        <textarea id="code3" spellcheck="false" rows="10"></textarea>
        <div class="actions">
            <button onclick="runCode(3)">‚ñ∂ Ejecutar</button>
            <button onclick="exportPDF(3)">üìÑ Exportar PDF</button>
        </div>
        <div id="console3" class="console"></div>
    </div>

    <script>
        // === Contenido de script.js (Corregido) ===
        
        // --- 1. Habilitar Tabulaci√≥n ---
        document.querySelectorAll("textarea").forEach(area => {
            area.addEventListener("keydown", function(e) {
                if (e.key === "Tab") {
                    e.preventDefault();
                    const start = this.selectionStart;
                    const end = this.selectionEnd;
                    this.value = this.value.substring(0, start) + "    " + this.value.substring(end);
                    this.selectionStart = this.selectionEnd = start + 4;
                }
            });
        });

        // --- 2. Casos de Prueba (A√±adido caso de prueba que detecta salida multi-l√≠nea) ---
        function getTests(num) {
            if (num === 1) {
                return [
                    { input: [1, 2, 3], expected: "Ascendente" },
                    { input: [3, 2, 1], expected: "Descendente" },
                    { input: [2, 1, 3], expected: "Sin orden" },
                    { input: [1, 1, 3], expected: "Ascendente" }, 
                    { input: [3, 3, 1], expected: "Descendente" }, 
                    { input: [1, 1, 1], expected: "Sin orden" } 
                ];
            } else if (num === 2) {
                return [
                    { input: [5], expected: "15", description: "Verificaci√≥n de la suma." },
                    { input: [3], expected: "6", description: "Verificaci√≥n de la suma." },
                    { input: [10], expected: "55", description: "Verificaci√≥n de la suma." },
                    { input: [1], expected: "1", description: "Verificaci√≥n de la suma." },
                    // NUEVO CASO DE PRUEBA: Verifica que la salida sea UNA sola l√≠nea
                    { input: [2], expected: "3", description: "Verificaci√≥n de l√≠nea √∫nica." }
                ];
            } else if (num === 3) {
                return [
                    { input: [5, -3, 9, -1, -7, 0], expected: "3", description: "Verificaci√≥n de conteo (3 negativos)." },
                    { input: [1, 2, 3, 0], expected: "0", description: "Verificaci√≥n de conteo (0 negativos)." },
                    { input: [-5, -10, 0], expected: "2", description: "Verificaci√≥n de conteo (2 negativos)." },
                    // NUEVO CASO DE PRUEBA: Verifica que la salida sea UNA sola l√≠nea
                    { input: [-1, -2, 0], expected: "2", description: "Verificaci√≥n de l√≠nea √∫nica." }
                ];
            }
            return [];
        }

        // --- 3. Ejecuci√≥n del C√≥digo (Traducci√≥n y Evaluaci√≥n con verificaci√≥n de l√≠nea √∫nica) ---
        function runCode(num) {
            const code = document.getElementById("code" + num).value;
            const consoleBox = document.getElementById("console" + num);
            consoleBox.innerHTML = "";

            let passed = 0;
            let total = 0;
            let results = "";

            const testCases = getTests(num);

            testCases.forEach(test => {
                total++;
                let output = "";

                const fakeConsole = {
                    log: (msg) => output += msg + "\n"
                };

                // **LIMPIEZA DE SINTAXIS**
                let jsCode = code
                    .replace(/import\s+.*?;/g, "") 
                    .replace(/Scanner\s+sc\s*=\s*new\s+Scanner\(System\.in\);/g, "")
                    .replace(/public\s+class\s+\w+\s*\{/g, "") 
                    .replace(/public\s+static\s+void\s+main\s*\(.*?\)\s*\{/g, "") 
                    .replace(/\}\s*$/g, "") 
                    .replace(/\}[\s\n]*\}/g, " ") 

                    // 3. Traducciones Java ‚Üí JS
                    .replace(/System\.out\.println\s*\((.*?)\)\s*;/g, "fakeConsole.log($1);") 
                    .replace(/\b(int|float|double)\s+/g, "let ") 
                    .replace(/for\s*\(\s*let\s+([a-zA-Z0-9_]+)\s*=/g, "for (let $1 =") 
                    .replace(/sc\.nextInt\s*\(\)\s*;/g, "fakePrompt();")
                    .replace(/nextInt\s*\(\)\s*;/g, "fakePrompt();")
                    .replace(/System\.exit\(0\);?/g, "");
                
                jsCode = jsCode.trim();
                jsCode = jsCode.replace(/[\{\}]/g, " "); // Reemplazar todas las llaves restantes con un espacio.

                let prompts = [...test.input];
                function fakePrompt() {
                    return String(prompts.shift()); 
                }

                try {
                    // Ejecuta el c√≥digo JavaScript resultante
                    new Function("fakeConsole", "fakePrompt", jsCode)(fakeConsole, fakePrompt);
                    
                    output = output.trim();
                    const lines = output.split("\n").filter(l => l.trim() !== "");
                    
                    const expectedOutput = String(test.expected);
                    let resultLine = lines[lines.length - 1]; 
                    
                    let isCorrect = resultLine === expectedOutput;
                    let failureReason = "";

                    // **VERIFICACI√ìN CLAVE: L√çNEA √öNICA (Solo para Ejercicios 2 y 3)**
                    if ((num === 2 || num === 3) && lines.length > 1) {
                         isCorrect = false;
                         failureReason = `<div class="result-warn">‚ùå FALLO DE FORMATO: Se detectaron ${lines.length} l√≠neas de salida. Solo se espera una.</div>`;
                    }


                    if (isCorrect) {
                        passed++;
                        results += `<div class="result-pass">‚úî Prueba ${total}: ${test.description} ‚Üí salida: ${resultLine} (correcto)</div>`;
                    } else {
                        // Si el fallo es por formato, mostrar el error de formato primero
                        if (failureReason) {
                            results += failureReason;
                        }
                        // Mostrar el fallo por contenido
                         results += `<div class="result-fail">‚ùå Prueba ${total}: ${test.description} ‚Üí salida obtenida: ${output || "(vac√≠o)"} (esperado: ${expectedOutput})</div>`;
                    }

                } catch (err) {
                    results += `<div class="result-error">üí• Error en prueba ${total}: ${test.description} : ${err.message}</div>`;
                }
            });

            results += `<br><strong>Resultado: ${passed}/${total} pruebas superadas.</strong>`;
            consoleBox.innerHTML = results;
        }

        // --- 4. Exportar PDF ---
        function exportPDF(num) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const nombre = prompt("Ingrese Nombre y Apellido:");
            const ci = prompt("Ingrese CI:");

            const consignas = [
                `1) (___ ptos) Crea un programa en Java que solicite tres n√∫meros y luego imprima "Ascendente", "Descendente" o "Sin orden".
Ejemplos: (1,2,3) ‚Üí Ascendente ; (3,2,1) ‚Üí Descendente ; (2,1,3) ‚Üí Sin orden ; (1,1,1) ‚Üí Sin orden.`,

                `2) (___ ptos) Crear un programa que solicite un n√∫mero entero y calcule la suma desde 1 hasta dicho n√∫mero. *SOLO DEBE IMPRIMIR EL RESULTADO FINAL.*
Ejemplo: Entrada 5 ‚Üí salida 15.`,

                `3) (___ ptos) Realizar un programa que solicita n√∫meros enteros al usuario. Al presionar 0 el programa no pedir√° m√°s n√∫meros y deber√° indicar cu√°ntos de los n√∫meros ingresados fueron negativos. *SOLO DEBE IMPRIMIR EL RESULTADO FINAL.*
Ejemplo: Entrada (5, -3, 9, -1, -7, 0) ‚Üí salida 3.`
            ];

            const code = document.getElementById("code" + num).value;
            const results = document.getElementById("console" + num).innerText;

            doc.setFont("helvetica", "normal");
            doc.setFontSize(14);
            doc.text("Acreditaci√≥n Septiembre 2025 ‚Äì Programaci√≥n 1", 10, 15);

            doc.setFontSize(12);
            doc.text(`Estudiante: ${nombre || "N/A"}`, 10, 25);
            doc.text(`CI: ${ci || "N/A"}`, 10, 32);

            doc.setFontSize(11);
            doc.text(consignas[num-1], 10, 45, {maxWidth: 180});

            doc.setFont("courier", "normal");
            doc.text("C√≥digo:", 10, 70);
            doc.setFontSize(9);
            const lines = code.split('\n');
            let y = 78;
            for (const line of lines) {
                if (y > 270) {
                    doc.addPage();
                    y = 10;
                }
                doc.text(line, 10, y);
                y += 4;
            }

            doc.setFont("helvetica", "normal");
            doc.setFontSize(11);
            doc.text("Resultados de las pruebas:", 10, y + 10);
            doc.setFont("courier", "normal");
            doc.setFontSize(9);
            doc.text(results || "(sin ejecutar)", 10, y + 18, {maxWidth: 180});

            doc.save(`ejercicio${num}_acreditacion.pdf`);
        }
        
        // --- 5. C√≥digo Java de Ejemplo (Cuerpo del main) ---
        document.addEventListener('DOMContentLoaded', () => {
            // C√ìDIGO CORREGIDO PARA CUMPLIR CON LA REGLA DE L√çNEA √öNICA
            document.getElementById('code1').value = `Scanner sc = new Scanner(System.in); 

int a = sc.nextInt();
int b = sc.nextInt();
int c = sc.nextInt();

if (a <= b && b <= c && (a != b || b != c)) { 
    System.out.println("Ascendente");
} else if (a >= b && b >= c && (a != b || b != c)) { 
    System.out.println("Descendente");
} else {
    System.out.println("Sin orden");
}`;
            // C√ìDIGO CORRECTO: Solo imprime el resultado final
            document.getElementById('code2').value = `Scanner sc = new Scanner(System.in); 
int n = sc.nextInt();
int suma = 0;

for (int i = 1; i <= n; i++) {
    suma = suma + i;
}

System.out.println(suma);`;

            // C√ìDIGO CORRECTO: Solo imprime el resultado final
            document.getElementById('code3').value = `Scanner sc = new Scanner(System.in); 
int negativos = 0;
int num;

do {
    num = sc.nextInt(); 

    if (num < 0) {
        negativos++;
    }
} while (num != 0);

System.out.println(negativos);`;
        });
    </script>
</body>
</html>